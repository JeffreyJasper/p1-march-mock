<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Jeremy Êï∏Â≠∏ÂÅµÊé¢ V5.4</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&display=swap');
        body { 
            font-family: 'Noto Sans TC', sans-serif; 
            background-color: #f8fafc;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }
        button { touch-action: manipulation; }
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        
        // --- ÂúñÊ®ôÁµÑ‰ª∂ ---
        const Icon = {
            Search: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>,
            Trophy: ({className}) => <svg className={className} width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"/><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"/><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"/></svg>,
            Bike: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="18.5" cy="17.5" r="3.5"/><circle cx="5.5" cy="17.5" r="3.5"/><circle cx="15" cy="5" r="1"/><path d="M7 17.5 9.5 8.5H15l1.5 5H21"/><path d="M12 13.5h2.5l2 4.5"/><path d="M5.5 14h1.5"/></svg>,
            Check: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M20 6 9 17l-5-5"/></svg>,
            Alert: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>,
            Next: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m9 18 6-6-6-6"/></svg>,
            Refresh: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8"/><polyline points="21 3 21 8 16 8"/></svg>,
            Flag: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"/><line x1="4" y1="22" x2="4" y2="15"/></svg>
        };

        const FOODS = ['üçé', 'üç©', 'üçû', 'üßÄ', 'üçå', 'üçï', 'üßÅ', 'üç¶'];
        const CAR_COLORS = [
            { name: 'Á¥ÖËªä', color: 'bg-red-500' },
            { name: 'Á¥´Ëªä', color: 'bg-purple-500' },
            { name: 'Á∂†Ëªä', color: 'bg-green-500' },
            { name: 'ÁÅ∞Ëªä', color: 'bg-gray-500' }
        ];

        // --- Â≠êÁµÑ‰ª∂ÔºöÊôÇÈêò ---
        const ClockFace = ({ h, m, color = "#1e293b", size = 180 }) => {
            const hourAngle = (h * 30) + (m * 0.5);
            const minuteAngle = m * 6;
            return (
                <div className="flex justify-center my-4">
                    <svg width={size} height={size} viewBox="0 0 200 200" className="drop-shadow-xl">
                        <circle cx="100" cy="100" r="95" fill="white" stroke={color} strokeWidth="5" />
                        {[...Array(12)].map((_, i) => (
                            <text key={i} x={100 + 72 * Math.sin((i+1)*Math.PI/6)} y={105 - 72 * Math.cos((i+1)*Math.PI/6)} textAnchor="middle" className="font-black text-xl" fill={color}>{i+1}</text>
                        ))}
                        <line x1="100" y1="100" x2={100 + 40 * Math.sin(hourAngle * Math.PI / 180)} y2={100 - 40 * Math.cos(hourAngle * Math.PI / 180)} stroke={color} strokeWidth="10" strokeLinecap="round" />
                        <line x1="100" y1="100" x2={100 + 70 * Math.sin(minuteAngle * Math.PI / 180)} y2={100 - 70 * Math.cos(minuteAngle * Math.PI / 180)} stroke="#ef4444" strokeWidth="6" strokeLinecap="round" />
                        <circle cx="100" cy="100" r="7" fill={color} />
                    </svg>
                </div>
            );
        };

        const App = () => {
            const [stage, setStage] = useState('menu');
            const [score, setScore] = useState(0);
            const [currentQIndex, setCurrentQuestionIndex] = useState(0);
            const [quizSet, setQuizSet] = useState([]);
            const [selectedAnswer, setSelectedAnswer] = useState(null);
            const [multiSelected, setMultiSelected] = useState([]);
            const [isCorrect, setIsCorrect] = useState(null);
            const [showRationale, setShowRationale] = useState(false);
            
            // ‰∫íÂãïÊôÇÈêòÁãÄÊÖã
            const [drawHour, setDrawHour] = useState(12);
            const [drawMinute, setDrawMinute] = useState(0);

            const shuffle = (arr) => [...arr].sort(() => Math.random() - 0.5);

            // --- Ê†∏ÂøÉÔºö‰∏ÄÊ¨°ÊÄßÁîüÊàê 15 Ê¢ù‰∏çÈáçË§áÈ°åÁõÆ ---
            const generateQuizSet = () => {
                let questions = [];

                // 1. ‰ΩçÁΩÆÔºöÈ£üÁâ©Ê´É (Â∑¶/Âè≥)
                const grid1 = shuffle([...FOODS]);
                const gridA = [grid1.slice(0,4), grid1.slice(4,8)];
                const rA = 0, cA = 1; 
                questions.push({
                    type: 'È£üÁâ©Ê´É‰ΩçÁΩÆ',
                    text: `ÁúãÁúã‰∏ãÂúñÔºö${gridA[rA][cA]} Âú® ${gridA[rA][cA-1]} ÁöÑÂì™‰∏ÄÈù¢Ôºü`,
                    visual: { type: 'grid', data: gridA },
                    options: ['Â∑¶Èù¢', 'Âè≥Èù¢', '‰∏äÈù¢', '‰∏ãÈù¢'],
                    correct: 'Âè≥Èù¢'
                });

                // 2. ‰ΩçÁΩÆÔºöÈ£üÁâ©Ê´É (‰∏ä/‰∏ã)
                const grid2 = shuffle([...FOODS]);
                const gridB = [grid2.slice(0,4), grid2.slice(4,8)];
                const rB = 0, cB = 2;
                questions.push({
                    type: 'È£üÁâ©Ê´É‰ΩçÁΩÆ',
                    text: `ÁúãÁúã‰∏ãÂúñÔºö${gridB[rB][cB]} Âú® ${gridB[rB+1][cB]} ÁöÑÂì™‰∏ÄÈù¢Ôºü`,
                    visual: { type: 'grid', data: gridB },
                    options: ['Â∑¶Èù¢', 'Âè≥Èù¢', '‰∏äÈù¢', '‰∏ãÈù¢'],
                    correct: '‰∏äÈù¢'
                });

                // 3. ‰ΩçÁΩÆÔºöÈ£üÁâ©Ê´É (‰πãÈñì)
                const grid3 = shuffle([...FOODS]);
                const gridC = [grid3.slice(0,4), grid3.slice(4,8)];
                questions.push({
                    type: 'È£üÁâ©Ê´É‰ΩçÁΩÆ',
                    text: `Âú® ${gridC[0][0]} Âíå ${gridC[0][3]} ‰πãÈñìÊúâÂ§öÂ∞ëÂÄãÈ£üÁâ©Ôºü`,
                    visual: { type: 'grid', data: gridC },
                    options: ['1', '2', '3'],
                    correct: '2'
                });

                // 4. ËªäÈöäÔºöÂâçÂæå (ÂñÆÈÅ∏)
                const cars1 = shuffle([...CAR_COLORS]);
                const targetIdx = Math.floor(Math.random() * 2) + 1; // 1 or 2 (middle)
                const targetCar = cars1[targetIdx];
                const frontCar = cars1[targetIdx-1];
                questions.push({
                    type: 'ËªäÂ≠êÊéíÂàó',
                    text: `ÁúãÁúã‰∏ãÂúñÔºö${targetCar.name} Âú® ${frontCar.name} ÁöÑÂì™‰∏ÄÈÇäÔºü`,
                    visual: { type: 'cars', data: cars1 },
                    options: ['ÂâçÈù¢', 'ÂæåÈù¢'],
                    correct: 'ÂæåÈù¢'
                });

                // 5. ËªäÈöäÔºöÂ§öÈÅ∏ (ÂæåÈù¢ÊúâË™∞)
                const cars2 = shuffle([...CAR_COLORS]);
                const targetCar2 = cars2[1]; // ÂÅáË®≠Á∂†ËªäÂú®Á¨¨‰∫å‰Ωç
                const answerCars = cars2.slice(2).map(c => c.name); // ÂæåÈù¢ÂÖ©Êû∂
                questions.push({
                    type: 'ËªäÂ≠êÊéíÂàó (Â§öÈÅ∏)',
                    text: `Â§öÈÅ∏È°åÔºö${targetCar2.name} ÁöÑÂæåÈù¢ÊúâÂì™‰∫õËªäÔºü(Ë´ãÈªûÈÅ∏)`,
                    visual: { type: 'cars', data: cars2 },
                    isMulti: true,
                    options: cars2.map(c => c.name),
                    correct: answerCars
                });
                
                // 6. Ë∑ùÈõ¢ÔºöÂñÆËªäÊØîË≥Ω (ÊúÄÈÅ†)
                const bike1 = shuffle([{n:'ÂèØÊô¥', d:80}, {n:'ÊüèÂ∫∑', d:30}, {n:'Ë±™Â∫≠', d:60}]);
                questions.push({
                    type: 'Ë∑ùÈõ¢ÊØîËºÉ',
                    text: "ÁúãÂúñ‰∏≠ÁöÑÂñÆËªäÊØîË≥ΩÔºåË™∞Ë∑ùÈõ¢„ÄåËµ∑Èªû„ÄçÊúÄÈÅ†Ôºü",
                    visual: { type: 'bike', data: bike1 },
                    options: bike1.map(b => b.n),
                    correct: bike1.reduce((prev, current) => (prev.d > current.d) ? prev : current).n
                });

                // 7. Ë∑ùÈõ¢ÔºöÂñÆËªäÊØîË≥Ω (ÊúÄËøë)
                const bike2 = shuffle([{n:'ÂèØÊô¥', d:70}, {n:'ÊüèÂ∫∑', d:20}, {n:'Ë±™Â∫≠', d:90}]);
                questions.push({
                    type: 'Ë∑ùÈõ¢ÊØîËºÉ',
                    text: "ÁúãÂúñ‰∏≠ÁöÑÂñÆËªäÊØîË≥ΩÔºåË™∞Ë∑ùÈõ¢„ÄåËµ∑Èªû„ÄçÊúÄËøëÔºü",
                    visual: { type: 'bike', data: bike2 },
                    options: bike2.map(b => b.n),
                    correct: bike2.reduce((prev, current) => (prev.d < current.d) ? prev : current).n
                });

                // 8. Èï∑Â∫¶ÔºöÁπ©Â≠êÊØîËºÉ
                const lines = [
                    {c: 'bg-red-500', n: 'Á¥ÖËâ≤', w: 40}, 
                    {c: 'bg-blue-500', n: 'ËóçËâ≤', w: 90}, 
                    {c: 'bg-green-500', n: 'Á∂†Ëâ≤', w: 60}
                ];
                questions.push({
                    type: 'Èï∑Â∫¶ÊØîËºÉ',
                    text: "Âì™‰∏ÄÊ¢ùÈ°èËâ≤Á∑öÊúÄÈï∑Ôºü",
                    visual: { type: 'lines', data: lines },
                    options: lines.map(l => l.n),
                    correct: 'ËóçËâ≤'
                });

                // 9. ÈáèÂ∫¶ÔºöÂñÆ‰ΩçÈÅ∏Êìá
                const items = [{n:'Êõ∏Ê´É', a:'ÈûãÂ≠ê', i:'üóÑÔ∏è'}, {n:'Êì¶ËÜ†', a:'Ëê¨Â≠óÂ§æ', i:'‚úèÔ∏è'}, {n:'ÈªëÊùø', a:'Èï∑Â∞∫', i:'üè´'}];
                const itemQ = items[Math.floor(Math.random() * items.length)];
                questions.push({
                    type: 'ÈáèÂ∫¶ÂñÆ‰Ωç',
                    text: `Ë¶ÅÈáèÂ∫¶„Äå${itemQ.n}„ÄçÁöÑÈï∑Â∫¶ÔºåÁî®‰ªÄÈ∫ºÂ∑•ÂÖ∑ÊúÄÂêàÈÅ©Ôºü`,
                    visual: { type: 'unit', icon: itemQ.i },
                    options: ['Ëê¨Â≠óÂ§æ', 'ÈûãÂ≠ê', 'Èï∑Â∞∫'],
                    correct: itemQ.a
                });

                // 10. ÈáèÂ∫¶ÔºöÊï∏Ëê¨Â≠óÂ§æ
                const count = Math.floor(Math.random() * 4) + 3; // 3-6
                questions.push({
                    type: 'ÈáèÂ∫¶ËÆÄÊï∏',
                    text: "Âúñ‰∏≠ÁöÑÁ≠ÜË¢ãÂ§ßÁ¥ÑÈï∑Â§öÂ∞ëÂÄã„ÄåËê¨Â≠óÂ§æ„ÄçÔºü",
                    visual: { type: 'count', count: count },
                    options: [(count-1).toString(), count.toString(), (count+1).toString()],
                    correct: count.toString()
                });

                // 11. ÊôÇÈñìÔºö‰∫íÂãïÊí•ÊôÇÈêò (ÂçäÈªû)
                const h1 = Math.floor(Math.random() * 12) + 1;
                questions.push({
                    type: 'Êí•ÊôÇÈêò',
                    text: `Ë´ãÊí•ÂãïÊåáÈáùÔºåÁï´Âá∫„Äå${h1} ÊôÇÂçä„Äç„ÄÇ`,
                    visual: { type: 'draw' },
                    targetH: h1, targetM: 30,
                    options: [], // ‰∫íÂãïÈ°åÁÑ°ÈÅ∏È†Ö
                    correct: 'draw'
                });

                // 12. ÊôÇÈñìÔºö‰∫íÂãïÊí•ÊôÇÈêò (Ê≠£Èªû)
                const h2 = Math.floor(Math.random() * 12) + 1;
                questions.push({
                    type: 'Êí•ÊôÇÈêò',
                    text: `Ë´ãÊí•ÂãïÊåáÈáùÔºåÁï´Âá∫„Äå${h2} ÊôÇÊ≠£„Äç„ÄÇ`,
                    visual: { type: 'draw' },
                    targetH: h2, targetM: 0,
                    options: [],
                    correct: 'draw'
                });

                // 13. ÊôÇÈñìÔºöÁ∂ìÈÅéÊôÇÈñì (Á∞°ÂñÆ)
                const startH = Math.floor(Math.random() * 5) + 1; // 1-5
                const dur = Math.floor(Math.random() * 3) + 2; // 2-4
                const endH = startH + dur;
                questions.push({
                    type: 'ÊôÇÈñìÊáâÁî®',
                    text: `ÁèæÂú®ÊòØ ${startH} ÊôÇÔºå${dur} Â∞èÊôÇÂæåÊòØÂπæÊôÇÔºü`,
                    visual: { type: 'clock_add', h: startH, add: dur },
                    options: [`${endH}ÊôÇ`, `${endH+1}ÊôÇ`, `${endH-1}ÊôÇ`],
                    correct: `${endH}ÊôÇ`
                });

                // 14. ÊôÇÈñìÔºöË∂ïÂ∑¥Â£´ (ÊáâÁî®È°å)
                const schoolH = 8;
                const schoolDur = 4;
                const busH = 12; // ÂâõÂ•ΩË∂ï‰∏ä
                questions.push({
                    type: 'ÊôÇÈñìÊáâÁî®',
                    text: `‰∏äÂçà ${schoolH} ÊôÇ‰∏äÂ≠∏Ôºå${schoolDur} Â∞èÊôÇÂæåÊîæÂ≠∏„ÄÇËÉΩË∂ï‰∏ä ${busH} ÊôÇÈñãÂá∫ÁöÑÂ∑¥Â£´ÂóéÔºü`,
                    visual: { type: 'bus_check', h: busH },
                    options: ['ËÉΩ', '‰∏çËÉΩ'],
                    correct: 'ËÉΩ'
                });

                // 15. Áõ¥ÂºèÔºöÈÄ≤‰ΩçÂä†Ê≥ï
                const v1 = Math.floor(Math.random() * 20) + 15;
                const v2 = Math.floor(Math.random() * 8) + 3;
                questions.push({
                    type: 'Áõ¥ÂºèË®àÁÆó',
                    text: `Ë®àÁÆóÔºö${v1} + ${v2} = ?`,
                    visual: { type: 'vertical', v1, v2, op: '+' },
                    options: [(v1+v2).toString(), (v1+v2-10).toString(), (v1+v2+10).toString()],
                    correct: (v1+v2).toString()
                });

                return shuffle(questions); // ÊúÄÂæåÊâì‰∫ÇÊ¨°Â∫è
            };

            const startGame = () => {
                setQuizSet(generateQuizSet());
                setScore(0);
                setCurrentQuestionIndex(0);
                setStage('quiz');
                setDrawHour(12); setDrawMinute(0);
                setMultiSelected([]);
            };

            const handleAnswer = (ans) => {
                const q = quizSet[currentQIndex];
                
                // ËôïÁêÜÂ§öÈÅ∏
                if (q.isMulti) {
                    if (ans === 'confirm') {
                        const correctSet = q.correct.sort().join(',');
                        const userSet = multiSelected.sort().join(',');
                        finish(userSet === correctSet);
                    } else {
                        setMultiSelected(prev => prev.includes(ans) ? prev.filter(x=>x!==ans) : [...prev, ans]);
                    }
                    return;
                }

                // ËôïÁêÜÊí•ÊôÇÈêò
                if (q.visual.type === 'draw' && ans === 'confirm') {
                    const isOk = drawHour === q.targetH && drawMinute === q.targetM;
                    finish(isOk);
                    return;
                }

                // ÊôÆÈÄöÂñÆÈÅ∏
                if (ans !== 'confirm') {
                    finish(ans === q.correct);
                }
            };

            const finish = (isOk) => {
                setIsCorrect(isOk);
                if (isOk) setScore(s => s + 1);
                setShowRationale(true);
            };

            const nextQ = () => {
                if (currentQIndex >= 14) {
                    setStage('result');
                } else {
                    setCurrentQuestionIndex(p => p + 1);
                    setSelectedAnswer(null);
                    setShowRationale(false);
                    setIsCorrect(null);
                    setMultiSelected([]);
                    setDrawHour(12); setDrawMinute(0);
                }
            };

            // Ë¶ñË¶∫Ê∏≤ÊüìÁµÑ‰ª∂
            const VisualArea = ({ q }) => {
                const { type, data } = q.visual;
                
                if (type === 'grid') return (
                    <div className="grid grid-cols-4 gap-2 bg-amber-50 p-4 rounded-2xl border-4 border-amber-200">
                        {data.flat().map((v, i) => <div key={i} className="aspect-square bg-white rounded-xl flex items-center justify-center text-4xl shadow-sm">{v}</div>)}
                    </div>
                );

                if (type === 'cars') return (
                    <div className="relative pt-8 pb-2">
                        <div className="flex justify-between px-4 mb-2 text-slate-500 font-black text-xs">
                            <span className="flex items-center gap-1">‚¨ÖÔ∏è ËªäÈ†≠ (Ââç)</span>
                            <span className="flex items-center gap-1">ËªäÂ∞æ (Âæå) ‚û°Ô∏è</span>
                        </div>
                        <div className="flex items-center gap-4 bg-slate-100 p-6 rounded-2xl overflow-x-auto border-2 border-slate-200">
                            {data.map((car, i) => (
                                <button key={i} onClick={() => !showRationale && q.isMulti && handleAnswer(car.name)} 
                                    className={`shrink-0 w-16 h-10 ${car.color} rounded-t-xl rounded-b-md relative shadow-md transition-all 
                                    ${multiSelected.includes(car.name) ? 'ring-4 ring-indigo-500 scale-110' : ''}`}>
                                    <div className="absolute top-1 left-2 w-10 h-4 bg-white/30 rounded"></div>
                                    <div className="absolute -bottom-6 left-0 right-0 text-xs font-bold text-slate-600 text-center">{car.name}</div>
                                </button>
                            ))}
                        </div>
                    </div>
                );

                if (type === 'bike') return (
                    <div className="relative h-48 bg-white rounded-2xl border-2 border-dashed border-slate-300 p-4 overflow-hidden">
                        <div className="absolute left-6 top-0 bottom-0 w-1 bg-green-500 z-10"></div>
                        <div className="absolute left-2 top-2 text-xs font-black text-green-600 bg-white px-1">üö© Ëµ∑Èªû</div>
                        <div className="absolute right-2 top-2 text-xs font-black text-red-600 bg-white px-1">üèÅ ÁµÇÈªû</div>
                        {data.map((p, i) => (
                            <div key={i} className="absolute flex flex-col items-center transition-all" style={{ left: `${p.d}%`, top: `${25 + i * 30}%` }}>
                                <Icon.Bike />
                                <span className="text-xs font-black bg-slate-100 px-2 rounded-full shadow-sm mt-1">{p.n}</span>
                            </div>
                        ))}
                    </div>
                );

                if (type === 'lines') return (
                    <div className="space-y-6 p-6 bg-white rounded-2xl border">
                        {data.map((l, i) => (
                            <div key={i} className="flex items-center gap-2">
                                <span className="text-xs font-bold w-12">{l.n}</span>
                                <div className={`h-4 ${l.c} rounded-full shadow-sm`} style={{ width: `${l.w}%` }}></div>
                            </div>
                        ))}
                    </div>
                );

                if (type === 'unit') return <div className="text-8xl p-10 bg-indigo-50 rounded-3xl flex justify-center shadow-inner">{q.visual.icon}</div>;
                
                if (type === 'count') return (
                    <div className="flex flex-col items-center gap-4 p-6 bg-white rounded-2xl border">
                        <div className="w-full h-12 bg-blue-100 rounded-lg flex items-center px-4 border-2 border-blue-200">
                             <div className="w-full h-2 bg-blue-400 rounded-full"></div>
                        </div>
                        <div className="flex gap-1">
                            {[...Array(q.visual.count)].map((_, i) => (
                                <div key={i} className="w-8 h-4 border-2 border-slate-400 rounded-full flex items-center justify-center opacity-70 bg-slate-200"></div>
                            ))}
                        </div>
                        <p className="text-sm text-slate-400">‚Üë Ëê¨Â≠óÂ§æ ‚Üë</p>
                    </div>
                );

                if (type === 'draw') return (
                    <div className="flex flex-col items-center">
                        <ClockFace h={drawHour} m={drawMinute} color="#6366f1" />
                        <div className="flex gap-4">
                            <button onClick={() => setDrawHour(h => h===12?1:h+1)} className="bg-slate-800 text-white px-6 py-3 rounded-2xl font-black">+1 Â∞èÊôÇ</button>
                            <button onClick={() => setDrawMinute(m => m===0?30:0)} className="bg-slate-800 text-white px-6 py-3 rounded-2xl font-black">+30 ÂàÜ</button>
                        </div>
                    </div>
                );

                if (type === 'clock_add') return (
                    <div className="flex items-center justify-center gap-4 text-2xl font-black text-indigo-700 bg-indigo-50 p-6 rounded-3xl">
                        <ClockFace h={q.visual.h} m={0} size={80} />
                        <ArrowRight />
                        <div className="text-center">
                            <div className="text-sm text-slate-400">Á∂ìÈÅé</div>
                            <div>{q.visual.add} Â∞èÊôÇ</div>
                        </div>
                        <ArrowRight />
                        <div className="w-20 h-20 border-4 border-dashed border-indigo-300 rounded-full flex items-center justify-center text-indigo-300">?</div>
                    </div>
                );

                if (type === 'bus_check') return (
                    <div className="flex flex-col items-center">
                        <ClockFace h={q.visual.h} m={0} color="#dc2626" />
                        <div className="bg-red-100 text-red-600 px-4 py-1 rounded-full text-xs font-bold mt-2">Â∑¥Â£´ÈñãÂá∫ÊôÇÈñì</div>
                    </div>
                );
                
                if (type === 'vertical') return (
                    <div className="font-mono text-5xl flex flex-col items-center bg-white p-6 rounded-3xl border shadow-sm">
                        <div className="text-right w-32">
                            <div>{q.visual.v1}</div>
                            <div className="border-b-4 border-slate-800 pb-2 relative">
                                <span className="absolute -left-6">{q.visual.op}</span>
                                {q.visual.v2}
                            </div>
                            <div className="pt-2 text-indigo-600">?</div>
                        </div>
                    </div>
                );

                return null;
            };

            const q = quizSet[currentQIndex];

            return (
                <div className="min-h-screen p-4 flex flex-col items-center">
                    {stage === 'menu' && (
                        <div className="w-full max-w-xl bg-white p-12 rounded-[3rem] shadow-xl text-center border-t-8 border-indigo-600 mt-10">
                            <Icon.Trophy className="text-amber-400 mx-auto mb-6 animate-bounce w-24 h-24" />
                            <h2 className="text-3xl font-black mb-4 text-slate-800">ÂÖ®Êñπ‰ΩçÊï∏Â≠∏Â§ßÂÜíÈö™</h2>
                            <p className="text-slate-500 font-bold mb-10 leading-relaxed">
                                È°åÁõÆÁµï‰∏çÈáçË§áÔºÅ<br/>ÂåÖÂê´‰ΩçÁΩÆ„ÄÅÈï∑Â∫¶„ÄÅÊôÇÈñì„ÄÅÁõ¥ÂºèË®àÁÆó„ÄÇ
                            </p>
                            <button onClick={startGame} className="w-full bg-indigo-600 text-white py-6 rounded-3xl text-2xl font-black shadow-xl active:scale-95 transition-all">ÈñãÂßãÊåëÊà∞</button>
                        </div>
                    )}

                    {stage === 'quiz' && q && (
                        <div className="w-full max-w-xl space-y-6">
                            <header className="flex justify-between items-center bg-white p-4 rounded-3xl shadow-sm">
                                <div className="font-black text-slate-400 uppercase tracking-widest text-sm">Question</div>
                                <div className="bg-indigo-600 text-white px-4 py-1 rounded-full font-black text-lg">{currentQIndex + 1} / 15</div>
                            </header>

                            <div className="bg-white p-8 rounded-[3rem] shadow-md border border-slate-200">
                                <span className="px-4 py-1 bg-indigo-50 text-indigo-600 rounded-full text-xs font-black mb-6 inline-block uppercase tracking-widest">{q.type}</span>
                                <h3 className="text-2xl font-bold mb-8 text-slate-800 leading-snug">{q.text}</h3>
                                
                                <VisualArea q={q} />

                                <div className="mt-10 grid grid-cols-1 gap-4">
                                    {q.isMulti || q.visual.type === 'draw' ? (
                                        <button onClick={() => handleAnswer('confirm')} className="w-full bg-slate-900 text-white py-6 rounded-3xl text-xl font-black shadow-xl active:scale-95">Á¢∫Ë™çÁ≠îÊ°à</button>
                                    ) : (
                                        q.options.map((opt, i) => (
                                            <button key={i} onClick={() => handleAnswer(opt)} disabled={showRationale} className={`p-6 text-xl font-black rounded-3xl border-4 transition-all text-left ${showRationale && opt === q.correct ? 'border-green-500 bg-green-50' : 'border-slate-100 bg-slate-50 hover:border-indigo-300'}`}>
                                                {opt}
                                            </button>
                                        ))
                                    )}
                                </div>
                            </div>

                            {showRationale && (
                                <div className={`p-8 rounded-[2.5rem] shadow-2xl border-l-[12px] animate-in slide-in-from-bottom-8 duration-500 ${isCorrect ? 'bg-green-50 border-green-500' : 'bg-rose-50 border-rose-500'}`}>
                                    <div className="flex gap-4 items-center mb-4">
                                        {isCorrect ? <Icon.Check /> : <Icon.Alert />}
                                        <h4 className={`font-black text-2xl ${isCorrect ? 'text-green-800' : 'text-rose-800'}`}>{isCorrect ? 'Á≠îÂ∞ç‰∫ÜÔºÅ' : 'ÂÜçÊé•ÂÜçÂé≤ÔºÅ'}</h4>
                                    </div>
                                    <p className="text-lg font-bold mb-6 text-slate-600 italic">Ê≠£Á¢∫Á≠îÊ°àÔºö{Array.isArray(q.correct) ? q.correct.join('„ÄÅ') : q.correct}</p>
                                    <button onClick={nextQ} className="w-full bg-slate-900 text-white py-5 rounded-2xl font-black text-xl flex items-center justify-center gap-2 shadow-xl active:scale-95">‰∏ã‰∏ÄÈ°å <Icon.Next /></button>
                                </div>
                            )}
                        </div>
                    )}

                    {stage === 'result' && (
                        <div className="w-full max-w-xl bg-white p-12 rounded-[3.5rem] text-center shadow-2xl animate-in zoom-in-95 mt-10">
                            <Icon.Trophy className="text-amber-400 mx-auto mb-8 animate-bounce w-24 h-24" />
                            <h2 className="text-4xl font-black mb-4 text-slate-800">ÁâπË®ìÂÆåÊàêÔºÅ</h2>
                            <div className="text-6xl font-black text-indigo-600 mb-8">{Math.round((score / 15) * 100)}ÂàÜ</div>
                            <button onClick={() => setStage('menu')} className="w-full bg-slate-800 text-white py-6 rounded-3xl text-2xl font-black flex items-center justify-center gap-4 active:scale-95 transition-all"><Icon.Refresh /> ÂÜç‰æÜ‰∏ÄÊ¨°</button>
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
